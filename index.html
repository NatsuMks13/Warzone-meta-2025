<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Magnoria - Anime App</title>
  <style>
    body { font-family: sans-serif; background: #111; color: white; padding: 20px; }
    h1, h2 { color: #ffcc00; }
    .container { max-width: 500px; margin: auto; }
    input, button, select { width: 100%; margin: 5px 0; padding: 10px; }
    .anime { border: 1px solid #444; margin: 10px 0; padding: 10px; border-radius: 8px; }
    img { width: 100px; height: auto; border-radius: 5px; }
    .profile-pic { width: 100px; height: 100px; border-radius: 50%; object-fit: cover; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Bienvenue sur Magnoria</h1><!-- Formulaires -->
<div id="auth">
  <h2>Créer un compte</h2>
  <input type="text" id="newId" placeholder="Identifiant">
  <input type="password" id="newPass" placeholder="Mot de passe">
  <button onclick="register()">S'inscrire</button>

  <h2>Se connecter</h2>
  <input type="text" id="loginId" placeholder="Identifiant">
  <input type="password" id="loginPass" placeholder="Mot de passe">
  <button onclick="login()">Connexion</button>
</div>

<!-- Profil -->
<div id="profile" style="display:none">
  <h2>Mon Profil</h2>
  <input type="file" id="profileImg" onchange="uploadProfilePic()">
  <img id="profilePic" class="profile-pic" src="" alt="Photo de profil">
  <h3 id="userDisplay"></h3>

  <h3>Rechercher un anime</h3>
  <input type="text" id="searchBar" oninput="searchAnime()" placeholder="Rechercher...">
  <div id="animeList"></div>

  <h3>Mes favoris</h3>
  <div id="favorites"></div>
  <button onclick="logout()">Déconnexion</button>
</div>

  </div>  <script>
    let currentUser = null;

    function register() {
      const id = document.getElementById('newId').value;
      const pass = document.getElementById('newPass').value;
      localStorage.setItem(`user_${id}`, JSON.stringify({ pass, favorites: [], pic: '' }));
      alert('Compte créé. Vous pouvez vous connecter.');
    }

    function login() {
      const id = document.getElementById('loginId').value;
      const pass = document.getElementById('loginPass').value;
      const user = JSON.parse(localStorage.getItem(`user_${id}`));
      if (user && user.pass === pass) {
        currentUser = id;
        document.getElementById('auth').style.display = 'none';
        document.getElementById('profile').style.display = 'block';
        document.getElementById('userDisplay').innerText = id;
        if (user.pic) document.getElementById('profilePic').src = user.pic;
        loadFavorites();
        loadAnimeList();
      } else {
        alert('Identifiants invalides');
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById('auth').style.display = 'block';
      document.getElementById('profile').style.display = 'none';
    }

    function uploadProfilePic() {
      const file = document.getElementById('profileImg').files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        document.getElementById('profilePic').src = e.target.result;
        let user = JSON.parse(localStorage.getItem(`user_${currentUser}`));
        user.pic = e.target.result;
        localStorage.setItem(`user_${currentUser}`, JSON.stringify(user));
      };
      reader.readAsDataURL(file);
    }

    function loadAnimeList() {
      const animes = [
        { title: "Jujutsu Kaisen", img: "https://upload.wikimedia.org/wikipedia/en/thumb/e/e5/Jujutsu_Kaisen_Volume_1.jpg/220px-Jujutsu_Kaisen_Volume_1.jpg" },
        { title: "Attack on Titan", img: "https://upload.wikimedia.org/wikipedia/en/7/79/Shingeki_no_Kyojin_manga_volume_1.jpg" },
        { title: "Demon Slayer", img: "https://upload.wikimedia.org/wikipedia/en/thumb/3/30/Kimetsu_no_Yaiba_Volume_1.png/220px-Kimetsu_no_Yaiba_Volume_1.png" }
      ];
      const container = document.getElementById('animeList');
      container.innerHTML = '';
      animes.forEach(anime => {
        const div = document.createElement('div');
        div.className = 'anime';
        div.innerHTML = `<img src="${anime.img}"><p>${anime.title}</p><button onclick='addFavorite("${anime.title}", "${anime.img}")'>Ajouter aux favoris</button>`;
        container.appendChild(div);
      });
    }

    function addFavorite(title, img) {
      let user = JSON.parse(localStorage.getItem(`user_${currentUser}`));
      user.favorites.push({ title, img });
      localStorage.setItem(`user_${currentUser}`, JSON.stringify(user));
      loadFavorites();
    }

    function loadFavorites() {
      const container = document.getElementById('favorites');
      container.innerHTML = '';
      const user = JSON.parse(localStorage.getItem(`user_${currentUser}`));
      user.favorites.forEach(anime => {
        const div = document.createElement('div');
        div.className = 'anime';
        div.innerHTML = `<img src="${anime.img}"><p>${anime.title}</p>`;
        container.appendChild(div);
      });
    }

    function searchAnime() {
      const filter = document.getElementById('searchBar').value.toLowerCase();
      const list = document.getElementById('animeList').children;
      Array.from(list).forEach(item => {
        const title = item.innerText.toLowerCase();
        item.style.display = title.includes(filter) ? 'block' : 'none';
      });
    }
  </script></body>
</html>
